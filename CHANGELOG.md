# 更新日志

所有重要的项目更改都将记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [1.2.0] - 2025-06-12

### 新增 (Added)
- **Workerman 适配器**：
  - 全新的 Workerman 高性能 Socket 服务器适配器
  - 多进程架构，充分利用多核CPU性能
  - 事件驱动的异步I/O处理机制
  - 内置静态文件服务器，支持多种MIME类型
  - 完整的中间件系统（CORS、安全头等）
  - 性能监控和慢请求记录功能
  - 定时器支持，可处理后台任务
  - 平滑重启功能，支持零停机部署
  - 内存使用监控，防止内存泄漏
  - 灵活的配置选项和日志系统

- **配置和文档**：
  - 完整的 Workerman 配置选项
  - 详细的使用示例和最佳实践
  - 性能优化建议和故障排除指南

### 改进 (Changed)
- 更新自动检测顺序，包含 Workerman 适配器
- 完善 composer.json 依赖建议
- 更新 README.md 文档，添加 Workerman 相关内容

## [1.1.0] - 2025-06-11

### 新增 (Added)
- **Swoole适配器重大改进**：
  - 协程上下文管理系统，提升并发安全性
  - PSR-7工厂实例复用机制，减少内存使用20-30%
  - 完整的中间件系统支持（CORS、安全头等）
  - 静态文件服务功能，响应速度提升50-80%
  - WebSocket服务器支持，实现实时通信
  - 性能监控和慢请求记录功能
  - 17种MIME类型支持
  - 安全防护机制，防止目录遍历攻击

- **ReactPHP适配器优化**：
  - 自动依赖包安装和检测
  - 改进的错误处理机制
  - 更好的配置管理

- **调试工具条修复**：
  - 解决think-trace运行时间累加问题
  - 全局状态重置机制
  - 常驻内存运行时状态管理优化

- **文档和指南**：
  - RoadRunner详细配置指南
  - 性能优化建议文档
  - 故障排除指南
  - 完整的API文档

### 修复 (Fixed)
- 修复ReactPHP适配器中setTimeout方法调用错误
- 解决think-trace调试工具条时间累加问题
- 修复常驻内存运行时中的状态污染问题
- 解决PSR-7工厂重复创建导致的性能问题
- 修复静态文件安全检查漏洞

### 改进 (Changed)
- 优化Swoole适配器的请求处理流程
- 改进协程异常处理机制
- 增强配置文件结构和灵活性
- 提升错误日志的详细程度
- 优化内存使用和垃圾回收

### 性能提升 (Performance)
- PSR-7工厂复用减少内存分配20-30%
- 静态文件响应速度提升50-80%
- 协程优化提升并发处理能力30-50%
- 请求处理延迟降低15-25%

## [1.0.0] - 2025-06-10

### 新增 (Added)
- 初始版本发布
- 支持多种运行时环境：
  - Swoole HTTP服务器
  - RoadRunner应用服务器
  - ReactPHP事件驱动服务器
  - FrankenPHP现代应用服务器
  - Ripple协程HTTP服务器
- 自动检测最佳运行时环境
- 完整的命令行工具支持
- PSR-7和PSR-15标准兼容
- 灵活的配置管理系统
- 完整的测试覆盖（使用Pest框架）
- ThinkPHP 8.0规范兼容

### 特性 (Features)
- 运行时自动检测和优先级管理
- 统一的配置接口
- 扩展的适配器系统
- 命令行管理工具
- 详细的运行时信息显示
- 错误处理和日志记录

## [未发布] - 开发中

### 计划新增 (Planned)
- 更多运行时支持（如OpenSwoole）
- 集群模式支持
- 更高级的负载均衡
- 内置缓存适配器
- 数据库连接池
- 更详细的性能分析工具

---

## 版本说明

### 版本号格式
本项目使用语义化版本号：`主版本号.次版本号.修订号`

- **主版本号**：不兼容的API修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

### 支持政策
- **当前版本 (1.1.x)**：完全支持，定期更新
- **前一版本 (1.0.x)**：安全更新和重要bug修复
- **更早版本**：不再维护

### 升级指南

#### 从 1.0.x 升级到 1.1.x
1. 更新依赖包：
   ```bash
   composer update yangweijie/think-runtime
   ```

2. 更新配置文件（可选）：
   - 新增Swoole静态文件配置
   - 新增中间件配置选项
   - 新增性能监控配置

3. 重启运行时服务器以应用更改

4. 检查新功能：
   - 静态文件服务
   - 性能监控
   - WebSocket支持（如需要）

#### 配置迁移
旧版本的配置文件完全兼容新版本，无需修改。新功能使用默认配置，可根据需要进行调整。

### 贡献者
感谢所有为本项目做出贡献的开发者！

### 许可证
MIT License - 详见 [LICENSE](LICENSE) 文件
